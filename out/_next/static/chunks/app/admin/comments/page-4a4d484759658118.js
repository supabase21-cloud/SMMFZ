(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[409],{10:(e,t,a)=>{"use strict";a.d(t,{$v:()=>h,EO:()=>m,Lt:()=>d,Rx:()=>x,Zr:()=>v,ck:()=>f,r7:()=>p,wd:()=>u});var s=a(5155),r=a(2115),l=a(2278),n=a(9434),i=a(285);let d=l.bL;l.l9;let o=l.ZL,c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});c.displayName=l.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(o,{children:[(0,s.jsx)(c,{}),(0,s.jsx)(l.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});m.displayName=l.UC.displayName;let u=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};u.displayName="AlertDialogHeader";let f=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};f.displayName="AlertDialogFooter";let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold",a),...r})});p.displayName=l.hE.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});h.displayName=l.VY.displayName;let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.rc,{ref:t,className:(0,n.cn)((0,i.r)(),a),...r})});x.displayName=l.rc.displayName;let v=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.ZD,{ref:t,className:(0,n.cn)((0,i.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});v.displayName=l.ZD.displayName},1997:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var s=a(5155),r=a(2115),l=a(3473),n=a(6695),i=a(10),d=a(285),o=a(7481);let c=(0,a(157).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var m=a(5599),u=a(7223),f=a(8856);function p(){let[e,t]=(0,r.useState)([]),[a,p]=(0,r.useState)(!0),[h,x]=(0,r.useState)(null),[v,g]=(0,r.useState)(null),{toast:j}=(0,o.dj)(),y=(0,r.useCallback)(async()=>{p(!0);try{let e=(await (0,l.WF)()).filter(e=>Array.isArray(e.comments)&&e.comments.length>0&&"Pending"===e.status);t(e)}catch(e){console.error("Failed to fetch comment orders",e),j({title:"Error",description:"Could not fetch comments from the database.",variant:"destructive"})}finally{p(!1)}},[j]);(0,r.useEffect)(()=>{y()},[y]),(0,r.useEffect)(()=>{let e=()=>{"visible"===document.visibilityState&&window.location.reload()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]);let N=(e,t)=>{navigator.clipboard.writeText(e),j({title:"Copied!",description:"".concat(t," copied to clipboard.")})},w=e=>{g(e)},b=async()=>{v&&(x(v.id),await (0,l.Kv)(v.id,"Cancelled")?(j({title:"Order Cancelled",description:"The order has been cancelled and funds returned to the user."}),t(e=>e.filter(e=>e.id!==v.id))):j({title:"Error",description:"Failed to cancel the order.",variant:"destructive"}),g(null),x(null))};return(0,s.jsxs)("div",{className:"container mx-auto py-8",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Customer Comments"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Review and manage pending orders with custom comments."})]}),(0,s.jsxs)(d.$,{onClick:()=>y(),disabled:a,children:[(0,s.jsx)(c,{className:"mr-2 h-4 w-4 ".concat(a?"animate-spin":"")}),a?"Refreshing...":"Refresh"]})]}),a?(0,s.jsxs)("div",{className:"grid gap-6 mt-6 md:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsx)(f.E,{className:"h-64 w-full"}),(0,s.jsx)(f.E,{className:"h-64 w-full"}),(0,s.jsx)(f.E,{className:"h-64 w-full"})]}):0===e.length?(0,s.jsx)(n.Zp,{children:(0,s.jsx)(n.Wu,{className:"p-6 text-center text-muted-foreground",children:"No pending orders with comments found."})}):(0,s.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:e.map(e=>{var t,a;return(0,s.jsxs)(n.Zp,{className:"flex flex-col",children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsx)(n.ZB,{className:"text-xl",children:e.username}),(0,s.jsxs)(n.BT,{children:["Order placed on: ",new Date(e.createdAt).toLocaleDateString()]})]}),(0,s.jsxs)(n.Wu,{className:"space-y-4 flex-grow",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("span",{className:"font-medium text-sm",children:"Link:"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline text-sm break-all",children:e.link}),(0,s.jsx)(d.$,{variant:"ghost",size:"icon",className:"h-6 w-6 shrink-0",onClick:()=>N(e.link,"Link"),children:(0,s.jsx)(m.A,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"font-medium text-sm",children:["Comments (",null==(t=e.comments)?void 0:t.length,"):"]}),(0,s.jsxs)(d.$,{variant:"outline",size:"sm",onClick:()=>N(e.comments.join("\n"),"Comments"),children:[(0,s.jsx)(m.A,{className:"mr-2 h-3 w-3"}),"Copy All"]})]}),(0,s.jsx)("div",{className:"p-3 bg-muted rounded-md max-h-48 overflow-y-auto",children:(0,s.jsx)("ul",{className:"list-disc list-inside text-sm space-y-1",children:null==(a=e.comments)?void 0:a.map((e,t)=>(0,s.jsx)("li",{children:e},t))})})]})]}),(0,s.jsx)(n.wL,{children:(0,s.jsxs)(d.$,{variant:"destructive",className:"w-full",onClick:()=>w(e),disabled:!!h,children:[(0,s.jsx)(u.A,{className:"mr-2 h-4 w-4"}),h===e.id?"Cancelling...":"Cancel Order"]})})]},e.id)})}),(0,s.jsx)(i.Lt,{open:!!v,onOpenChange:e=>!e&&g(null),children:(0,s.jsxs)(i.EO,{children:[(0,s.jsxs)(i.wd,{children:[(0,s.jsx)(i.r7,{children:"Are you absolutely sure?"}),(0,s.jsxs)(i.$v,{children:["This will cancel the order and refund ",(0,s.jsxs)("span",{className:"font-bold",children:["PKR ",null==v?void 0:v.price.toFixed(2)]})," to ",(0,s.jsx)("span",{className:"font-bold",children:null==v?void 0:v.username}),". This action cannot be undone."]})]}),(0,s.jsxs)(i.ck,{children:[(0,s.jsx)(i.Zr,{children:"Close"}),(0,s.jsx)(i.Rx,{onClick:b,className:"bg-destructive hover:bg-destructive/90",children:"Yes, Cancel Order"})]})]})})]})}},2278:(e,t,a)=>{"use strict";a.d(t,{rc:()=>M,ZD:()=>P,UC:()=>T,VY:()=>$,hJ:()=>V,ZL:()=>S,bL:()=>Z,hE:()=>W,l9:()=>F});var s=a(2115),r=a(6081),l=a(6101),n=a(5821),i=a(5185),d=a(5155);s.forwardRef((e,t)=>{let{children:a,...r}=e,l=s.Children.toArray(a),n=l.find(m);if(n){let e=n.props.children,a=l.map(t=>t!==n?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,d.jsx)(o,{...r,ref:t,children:s.isValidElement(e)?s.cloneElement(e,void 0,a):null})}return(0,d.jsx)(o,{...r,ref:t,children:a})}).displayName="Slot";var o=s.forwardRef((e,t)=>{let{children:a,...r}=e;if(s.isValidElement(a)){let e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,a=t&&"isReactWarning"in t&&t.isReactWarning;return a?e.ref:(a=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}(a),n=function(e,t){let a={...t};for(let s in t){let r=e[s],l=t[s];/^on[A-Z]/.test(s)?r&&l?a[s]=(...e)=>{l(...e),r(...e)}:r&&(a[s]=r):"style"===s?a[s]={...r,...l}:"className"===s&&(a[s]=[r,l].filter(Boolean).join(" "))}return{...e,...a}}(r,a.props);return a.type!==s.Fragment&&(n.ref=t?(0,l.t)(t,e):e),s.cloneElement(a,n)}return s.Children.count(a)>1?s.Children.only(null):null});o.displayName="SlotClone";var c=({children:e})=>(0,d.jsx)(d.Fragment,{children:e});function m(e){return s.isValidElement(e)&&e.type===c}var u="AlertDialog",[f,p]=(0,r.A)(u,[n.Hs]),h=(0,n.Hs)(),x=e=>{let{__scopeAlertDialog:t,...a}=e,s=h(t);return(0,d.jsx)(n.bL,{...s,...a,modal:!0})};x.displayName=u;var v=s.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,r=h(a);return(0,d.jsx)(n.l9,{...r,...s,ref:t})});v.displayName="AlertDialogTrigger";var g=e=>{let{__scopeAlertDialog:t,...a}=e,s=h(t);return(0,d.jsx)(n.ZL,{...s,...a})};g.displayName="AlertDialogPortal";var j=s.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,r=h(a);return(0,d.jsx)(n.hJ,{...r,...s,ref:t})});j.displayName="AlertDialogOverlay";var y="AlertDialogContent",[N,w]=f(y),b=s.forwardRef((e,t)=>{let{__scopeAlertDialog:a,children:r,...o}=e,m=h(a),u=s.useRef(null),f=(0,l.s)(t,u),p=s.useRef(null);return(0,d.jsx)(n.G$,{contentName:y,titleName:C,docsSlug:"alert-dialog",children:(0,d.jsx)(N,{scope:a,cancelRef:p,children:(0,d.jsxs)(n.UC,{role:"alertdialog",...m,...o,ref:f,onOpenAutoFocus:(0,i.m)(o.onOpenAutoFocus,e=>{var t;e.preventDefault(),null==(t=p.current)||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,d.jsx)(c,{children:r}),(0,d.jsx)(L,{contentRef:u})]})})})});b.displayName=y;var C="AlertDialogTitle",k=s.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,r=h(a);return(0,d.jsx)(n.hE,{...r,...s,ref:t})});k.displayName=C;var A="AlertDialogDescription",R=s.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,r=h(a);return(0,d.jsx)(n.VY,{...r,...s,ref:t})});R.displayName=A;var E=s.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,r=h(a);return(0,d.jsx)(n.bm,{...r,...s,ref:t})});E.displayName="AlertDialogAction";var D="AlertDialogCancel",O=s.forwardRef((e,t)=>{let{__scopeAlertDialog:a,...s}=e,{cancelRef:r}=w(D,a),i=h(a),o=(0,l.s)(t,r);return(0,d.jsx)(n.bm,{...i,...s,ref:o})});O.displayName=D;var L=e=>{let{contentRef:t}=e,a="`".concat(y,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(y,"` by passing a `").concat(A,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(y,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return s.useEffect(()=>{var e;document.getElementById(null==(e=t.current)?void 0:e.getAttribute("aria-describedby"))||console.warn(a)},[a,t]),null},Z=x,F=v,S=g,V=j,T=b,M=E,P=O,W=k,$=R},2876:(e,t,a)=>{Promise.resolve().then(a.bind(a,1997))},7223:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(157).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},8856:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(5155),r=a(9434);function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",t),...a})}}},e=>{var t=t=>e(e.s=t);e.O(0,[647,277,195,543,821,873,441,684,358],()=>t(2876)),_N_E=e.O()}]);