(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{157:(e,r,t)=>{"use strict";t.d(r,{A:()=>n});var s=t(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,s.forwardRef)((e,r)=>{let{color:t="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:n,className:c="",children:u,iconNode:d,...m}=e;return(0,s.createElement)("svg",{ref:r,...i,width:a,height:a,stroke:t,strokeWidth:n?24*Number(l)/Number(a):l,className:o("lucide",c),...m},[...d.map(e=>{let[r,t]=e;return(0,s.createElement)(r,t)}),...Array.isArray(u)?u:[u]])}),n=(e,r)=>{let t=(0,s.forwardRef)((t,i)=>{let{className:n,...c}=t;return(0,s.createElement)(l,{ref:i,iconNode:r,className:o("lucide-".concat(a(e)),n),...c})});return t.displayName="".concat(e),t}},286:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(157).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},2099:(e,r,t)=>{"use strict";t.d(r,{N:()=>i});var s=t(5647);let a="https://vjryvngvrqsxahfrrzyk.supabase.co",o="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZqcnl2bmd2cnFzeGFoZnJyenlrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIzMDkzMTAsImV4cCI6MjA2Nzg4NTMxMH0.UtURD4d8oWiVHQlpEoDZM1tsr3D-vWlbEgmU59CUrHc";if(!a||!o)throw Error("Supabase URL and/or anonymous key are not provided. Please check your .env.local file.");let i=(0,s.UU)(a,o)},3473:(e,r,t)=>{"use strict";t.d(r,{AR:()=>i,DY:()=>o,Gm:()=>d,Kv:()=>y,WF:()=>f,Z1:()=>l,bU:()=>u,h1:()=>c,hs:()=>m,lo:()=>w,r3:()=>h,u9:()=>v,wH:()=>p,wz:()=>a});var s=t(2099);let a=async e=>{let{data:r,error:t}=await s.N.from("users").select("*").eq("email",e).single();return t&&"PGRST116"!==t.code?(console.error("Error getting user:",t),null):r},o=async e=>{let{data:r,error:t}=await s.N.auth.signUp({email:e.email,password:e.password});if(t)return console.error("Supabase auth signup error:",t.message),{user:null,error:t.message};if(!r.user)return console.error("Supabase auth signup did not return a user."),{user:null,error:"Could not create user."};let a="user".concat(Math.floor(1e3+9e3*Math.random())),{data:o,error:i}=await s.N.from("users").insert({id:r.user.id,email:e.email,username:a,funds:0}).select().single();return i?(console.error("Error inserting user into database:",i),{user:null,error:"Could not save user profile."}):{user:o}},i=async(e,r)=>{let{data:t,error:a}=await s.N.from("users").update({funds:r}).eq("email",e).select().single();return a?(console.error("Error setting user funds:",a),null):t},l=async()=>{let{data:e,error:r}=await s.N.from("services").select("*").order("platform").order("type");return r?(console.error("Error getting services:",JSON.stringify(r,null,2)),[]):e||[]},n=async e=>{let{data:r,error:t}=await s.N.from("services").select("*").eq("id",e).single();return t?void console.error("Error getting service by ID:",t):r},c=async e=>{let r=e.map(e=>({...e,platform:e.platform.toLowerCase(),type:e.type.toLowerCase(),available:!0,user_cooldown_hours:0===e.price&&e.user_cooldown_hours||0,link_cooldown_hours:0===e.price&&e.link_cooldown_hours||0})),{data:t,error:a}=await s.N.from("services").insert(r).select();return a?(console.error("Error adding services:",a),null):t},u=async(e,r)=>{var t,a;let o={...r,platform:null==(t=r.platform)?void 0:t.toLowerCase(),type:null==(a=r.type)?void 0:a.toLowerCase()};0!==r.price&&(o.user_cooldown_hours=0,o.link_cooldown_hours=0);let{data:i,error:l}=await s.N.from("services").update(o).eq("id",e).select().single();return l?(console.error("Error updating service:",l),null):i},d=async(e,r)=>{let{data:t,error:a}=await s.N.from("services").update({available:r}).eq("id",e).select().single();return a?(console.error("Error updating service availability:",a),null):t},m=async e=>{let{error:r}=await s.N.from("services").delete().eq("id",e);return r?(console.error("Error deleting service:",r),{success:!1,error:r.message}):{success:!0}},f=async()=>{let{data:e,error:r}=await s.N.from("orders").select("*").order("created_at",{ascending:!1});return r?(console.error("Error getting orders:",JSON.stringify(r,null,2)),[]):(null==e?void 0:e.map(e=>({id:e.id,userEmail:e.user_email,username:e.username,serviceId:e.service_id,platform:e.platform,serviceType:e.service_type,quantity:e.quantity,price:e.price,status:e.status,link:e.url,createdAt:e.created_at,comments:Array.isArray(e.comments)?e.comments:null,user_cooldown_hours:e.user_cooldown_hours,link_cooldown_hours:e.link_cooldown_hours})))||[]},p=async e=>{let r=await a(e.userEmail),t=await n(e.serviceId);if(!r||!t||!t.available)return{success:!1,error:"User or service not found, or service is unavailable."};let o=e.quantity*t.price;if(r.funds<o)return{success:!1,error:"Insufficient funds."};if(t.type.toLowerCase().includes("comment")){if(0===e.quantity||!e.comments||0===e.comments.length)return{success:!1,error:"Comments cannot be empty for this service."}}else if(e.quantity<t.min||e.quantity>t.max)return{success:!1,error:"Quantity must be between ".concat(t.min," and ").concat(t.max,".")};if(0===o){let{user_cooldown_hours:r,link_cooldown_hours:a}=t;if(r>0){let t=new Date(Date.now()-60*r*6e4).toISOString(),{data:a,error:o}=await s.N.from("orders").select("created_at").eq("user_email",e.userEmail).eq("price",0).gt("created_at",t).order("created_at",{ascending:!1}).limit(1).single();if(o&&"PGRST116"!==o.code)return console.error("Error checking for recent user free orders:",o),{success:!1,error:"Could not verify free order eligibility."};if(a){let e=new Date(a.created_at).getTime()+60*r*6e4;return{success:!1,error:"You must wait ".concat(r," hour(s) between free orders."),errorType:"USER_COOLDOWN",cooldownExpiry:e}}}if(a>0){let r=new Date(Date.now()-60*a*6e4).toISOString(),{data:t,error:o}=await s.N.from("orders").select("created_at").eq("user_email",e.userEmail).eq("url",e.link).eq("price",0).gt("created_at",r).order("created_at",{ascending:!1}).limit(1).single();if(o&&"PGRST116"!==o.code)return console.error("Error checking for recent link free orders:",o),{success:!1,error:"Could not verify free order eligibility."};if(t)return{success:!1,error:"User is on cooldown for this free service and link.",errorType:"LINK_COOLDOWN",cooldownExpiry:new Date(t.created_at).getTime()+60*a*6e4}}}let l={user_email:e.userEmail,username:r.username,service_id:e.serviceId,platform:t.platform,service_type:t.type,quantity:e.quantity,price:o,url:e.link,status:"Pending",comments:e.comments},{data:c,error:u}=await s.N.from("orders").insert(l).select().single();if(u)return console.error("Error placing order:",JSON.stringify(u,null,2)),{success:!1,error:"Failed to create order in database."};if(o>0){let e=r.funds-o;await i(r.email,e)}return{success:!0,order:{id:c.id,userEmail:c.user_email,username:c.username,serviceId:c.service_id,platform:c.platform,serviceType:c.service_type,quantity:c.quantity,price:c.price,status:c.status,link:c.url,createdAt:c.created_at,comments:Array.isArray(c.comments)?c.comments:null,user_cooldown_hours:t.user_cooldown_hours,link_cooldown_hours:t.link_cooldown_hours}}},y=async(e,r)=>{let{data:t,error:o}=await s.N.from("orders").select("*").eq("id",e).single();if(o||!t)return console.error("Error fetching order to update status:",o),null;if("Pending"!==t.status)return null;if("Cancelled"===r&&t.price>0){let e=await a(t.user_email);if(e){let r=e.funds+t.price;await i(e.email,r)}}let{data:l,error:c}=await s.N.from("orders").update({status:r}).eq("id",e).select().single();if(c){if(console.error("Error updating order status:",c),"Cancelled"===r&&t.price>0){let e=await a(t.user_email);e&&await i(e.email,e.funds-t.price)}return null}let u=await n(l.service_id);return{id:l.id,userEmail:l.user_email,username:l.username,serviceId:l.service_id,platform:l.platform,serviceType:l.service_type,quantity:l.quantity,price:l.price,status:l.status,link:l.url,createdAt:l.created_at,comments:Array.isArray(l.comments)?l.comments:null,user_cooldown_hours:(null==u?void 0:u.user_cooldown_hours)||0,link_cooldown_hours:(null==u?void 0:u.link_cooldown_hours)||0}},w=async()=>{let{data:e,error:r}=await s.N.from("users").select("*");return r?[]:e||[]},h=()=>({instagram:{followers:0,likes:0},tiktok:{followers:0,likes:0},youtube:{followers:0,likes:0}}),v=e=>{}},4815:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(157).A)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},5573:(e,r,t)=>{Promise.resolve().then(t.bind(t,7220))},6695:(e,r,t)=>{"use strict";t.d(r,{BT:()=>c,Wu:()=>u,ZB:()=>n,Zp:()=>i,aR:()=>l,wL:()=>d});var s=t(5155),a=t(2115),o=t(9434);let i=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});i.displayName="Card";let l=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",t),...a})});l.displayName="CardHeader";let n=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});n.displayName="CardTitle";let c=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",t),...a})});c.displayName="CardDescription";let u=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("p-6 pt-0",t),...a})});u.displayName="CardContent";let d=a.forwardRef((e,r)=>{let{className:t,...a}=e;return(0,s.jsx)("div",{ref:r,className:(0,o.cn)("flex items-center p-6 pt-0",t),...a})});d.displayName="CardFooter"},7220:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u});var s=t(5155),a=t(2115),o=t(3473),i=t(6695),l=t(8390),n=t(286),c=t(4815);function u(){let[e,r]=(0,a.useState)(0),[t,u]=(0,a.useState)(0),[d,m]=(0,a.useState)(0),[f,p]=(0,a.useState)(!0),y=(0,a.useCallback)(async()=>{p(!0);try{let[e,t]=await Promise.all([(0,o.WF)(),(0,o.lo)()]),s=e.filter(e=>"Complete"===e.status).reduce((e,r)=>e+r.price,0);r(s),u(t.length),m(e.length)}catch(e){console.error("Failed to fetch admin dashboard data",e)}finally{p(!1)}},[]);return(0,a.useEffect)(()=>{y()},[y]),(0,a.useEffect)(()=>{let e=()=>{"visible"===document.visibilityState&&window.location.reload()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[]),(0,s.jsxs)("div",{className:"container mx-auto py-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Admin Dashboard"}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(i.ZB,{className:"text-sm font-medium",children:"Total Revenue"}),(0,s.jsx)(l.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(i.Wu,{children:[(0,s.jsxs)("div",{className:"text-2xl font-bold",children:["PKR ",e.toFixed(2)]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"From completed orders"})]})]}),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(i.ZB,{className:"text-sm font-medium",children:"Total Users"}),(0,s.jsx)(n.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:t})})]}),(0,s.jsxs)(i.Zp,{children:[(0,s.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(i.ZB,{className:"text-sm font-medium",children:"Total Orders"}),(0,s.jsx)(c.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(i.Wu,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:d})})]})]})]})}},8390:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(157).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},9434:(e,r,t)=>{"use strict";t.d(r,{cn:()=>o});var s=t(2596),a=t(9688);function o(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,a.QP)((0,s.$)(r))}}},e=>{var r=r=>e(e.s=r);e.O(0,[647,277,441,684,358],()=>r(5573)),_N_E=e.O()}]);